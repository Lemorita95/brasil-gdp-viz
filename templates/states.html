{% extends "layout.html" %}

{% block head %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.2.0/chartjs-plugin-datalabels.min.js" integrity="sha512-JPcRR8yFa8mmCsfrw4TNte1ZvF1e3+1SdGMslZvmrzDYxS69J7J49vkFL8u6u8PlPJK+H3voElBtUCzaXj+6ig==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="{{ url_for('static', filename='states.js')}}"></script>
{% endblock %}

{% block title %}
    States
{% endblock %}

{% block main %}

    <div name="states-input">
        <form action="/states" method="get" id="search-state">
            <div class="mb-3">
                <p><label for="stateInput">Choose a Brazilian State:</label></p>
                <!-- this will be the submitted value -->
                <select id="stateInput" name="stateInput" required>
                    <option disabled selected value="">Select</option>
                    {% for s in states %}
                        <option value="{{ s.name }}">{{ s.name }}</option>
                    {% endfor %}
                </select>
                <button class="btn btn-primary" type="submit">Update</button>
            </div>
        </form>
    </div>

    <h2 id="user-state" style="background: rgb(33,37,41); color: #ffffff; border-radius: 3px;"></h2>

    <div style="display:flex; flex-direction: row">
        <div name="div-states-chart" style="width:50%;">

            <div style="width: 100%; height: 100%;">
                <canvas id="states-chart"></canvas>
            </div>
         
        </div>
    
        <div style="width: 50%;" id="state-svg">
            {{ svg|safe }}
            <!-- to style as borders only -->
            <script>
                let svgState = document.querySelector("path");
    
                svgState.setAttribute("fill", "#fff");
                svgState.setAttribute("stroke", "#000000");
                svgState.setAttribute("stroke-width", "400");
    
                
            </script>
        </div>

    </div>


    <div name="states-table" class="mt-3">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th class="text-start">Year</th>
                    <th class="text-end">GDP in BRL</th>
                    <th class="text-end">Share of Country GDP</th>
                </tr>
            </thead>
            <tbody id="state-table-body">
                {% for g in gdp %}
                    <tr>
                        <td class="text-start">{{ g.year }}</td>
                        <td class="text-end">{{ g.valor | money }}</td>
                        <td class="text-end">{{ g.year_share | percentage }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

{% endblock %}
